@page "/timer/{RaceId}"
@inject RaceService raceService

<h1>@currentTime.ToString("HH:mm:ss.ff")</h1>



@code {
    [Parameter] public string RaceId { get; set; }
    private Race currentRace;
    private System.Timers.Timer timer;

    public DateTime currentTime;

    protected override async Task OnInitializedAsync()
    {
        currentRace = await raceService.GetRaceByIdAsync(RaceId);
        CreateUpdateTimer();
    }

    private void CreateUpdateTimer()
    {
        // Skapa en timer som tickar var 10:e millisekund (0.01 sekund).
        timer = new System.Timers.Timer(10);
        timer.Elapsed += OnTimerElapsed;
        timer.Start();
    }

    private void OnTimerElapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        currentTime = DateTime.Now;

        // Uppdaterar UI:t på huvudtråden
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        timer?.Dispose();
    }

}
