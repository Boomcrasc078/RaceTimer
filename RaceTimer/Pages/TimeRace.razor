@page "/timer/{RaceId}"
@inject RaceService raceService
<button class="btn btn-primary time-container">
    <h1 class="current-time text-center">@currentTime.ToString("HH:mm:ss.ff")</h1>
    <h2 class="btn-text text-center">Press to set time</h2>
</button>

<Numpad></Numpad>

@code {
    [Parameter] public string RaceId { get; set; }
    private Race currentRace;
    private System.Timers.Timer timer;

    public DateTime currentTime;

    protected override async Task OnInitializedAsync()
    {
        currentRace = await raceService.GetRaceByIdAsync(RaceId);
        CreateUpdateTimer();
    }

    private void CreateUpdateTimer()
    {
        // Skapa en timer som tickar var 10:e millisekund (0.01 sekund).
        timer = new System.Timers.Timer(10);
        timer.Elapsed += OnTimerElapsed;
        timer.Start();
    }

    private void OnTimerElapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        currentTime = DateTime.Now;

        // Uppdaterar UI:t på huvudtråden
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        timer?.Dispose();
    }
}